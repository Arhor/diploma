plugins {
    id "com.github.node-gradle.node"
    id "idea"
}

group = "org.arhor"
version = "0.0.1-SNAPSHOT"
description = "diploma-client"

node {
    version  = "${node_version}"
    download = true
}

idea {
    module {
        excludeDirs += files("node_modules")
    }
}

def jsRootDir = "${project.projectDir}"

task npmAuditFix (type: NpmTask, dependsOn: npmInstall) {
    description = "Verify and fix vulnerabilities in dependencies"
    workingDir = file(jsRootDir)
    args = ["audit", "fix"]
}

task clientBuild (type: NpmTask, dependsOn: npmAuditFix) {
    description = "Builds production version of the app client"
    workingDir = file(jsRootDir)
    args = ["run", "build"]
}

task clientStart (type: NpmTask, dependsOn: npmAuditFix) {
    description = "Starts client development server"
    workingDir = file(jsRootDir)
    args = ["run", "start"]
}
